// Generated by CoffeeScript 2.6.1
var DivItem;

import Box from "../common/box";

import Tag from "../common/tag";

import gEData from "./gameEditor_data";

import getColor from "../help/getColor";

DivItem = function() {
  return {
    view: function({attrs}) {
      var preDiv;
      preDiv = attrs.preDiv;
      return m(Box, {
        isBtn: true,
        color: preDiv.isGroup ? "yellow" : void 0,
        style: {
          margin: "0.2rem",
          padding: "0.5rem 1rem",
          borderRadius: "0.2rem",
          border: preDiv.hasBorder === 1 ? `0.2rem solid ${getColor("yellow").back}` : preDiv.hasBorder === 2 ? `0.2rem solid ${getColor("green").back}` : void 0,
          outline: preDiv.checked ? "0.2rem solid red" : void 0
        },
        ext: {
          onclick: (e) => {
            var fn;
            fn = (preDiv) => {
              var children;
              preDiv.inverse();
              children = gEData.divList.data.filter((preDiv1) => {
                return preDiv1.linkid === preDiv.id;
              });
              if (children.length > 0) {
                return children.forEach((child) => {
                  return fn(child);
                });
              }
            };
            fn(preDiv);
            return e.stopPropagation();
          }
        }
      }, [
        m("",
        [(preDiv.isGroup ? "组：" : "") + preDiv.x + " " + preDiv.y,
        preDiv.hideState ? "[藏]" : "",
        preDiv.lockState ? "[锁]" : ""]),
        gEData.divList.data.filter((preDiv) => {
          return preDiv.linkid === attrs.preDiv.id;
        }).map((preDiv) => {
          return m(DivItem,
        {
            preDiv: preDiv
          });
        })
      ]);
    }
  };
};

export default function() {
  return {
    view: function() {
      return m("", {
        style: {
          overflow: "auto"
        },
        onclick: () => {
          return gEData.divList.data.forEach((preDiv) => {
            return preDiv.unCheck();
          });
        }
      }, [
        m("",
        [
          m("",
          {
            style: {
              display: "inline-block",
              margin: "1rem",
              fontSize: "1.8rem",
              color: "#aaa"
            }
          },
          "图层"),
          m("",
          {
            style: {
              display: "inline-block",
              margin: "1rem",
              fontSize: "1.8rem",
              color: "#aaa"
            }
          },
          "地图"),
          m("",
          [
            m(Tag,
            {
              isBtn: true,
              color: "yellow",
              ext: {
                onclick: (e) => {
                  gEData.divList.getCheckedItems().forEach((preDiv) => {
                    return preDiv.lockOrUnlock();
                  });
                  return e.stopPropagation();
                }
              }
            },
            "锁定/解锁"),
            m(Tag,
            {
              isBtn: true,
              color: "red",
              ext: {
                onclick: (e) => {
                  gEData.divList.hideOrShowCheckedItems();
                  return e.stopPropagation();
                }
              }
            },
            "隐藏/显示")
          ])
        ]),
        m("",
        {
          style: {
            display: "flex",
            flexWrap: "wrap",
            background: "#fff"
          }
        },
        [
          gEData.divList.data.filter((preDiv) => {
            return preDiv.linkid === 0 || !preDiv.linkid;
          }).sort((x1,
          x2) => {
            return x1 - x2;
          }).map((preDiv) => {
            return m(DivItem,
          {
              preDiv: preDiv
            });
          })
        ])
      ]);
    }
  };
};
